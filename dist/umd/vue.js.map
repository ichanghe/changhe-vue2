{"version":3,"file":"vue.js","sources":["../../src/observer/array.js","../../src/util/index.js","../../src/observer/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["//原方法\nlet oldArrayProtoMethods = Array.prototype;\nexport let arrayMethods = Object.create(oldArrayProtoMethods)\nlet methods = [\n    'push',\n    'pop',\n    'shift',\n    'unshift',\n    'reverse',\n    'sort',\n    'splice'\n]\nmethods.forEach(method=>{\n    arrayMethods[method] = function(...args){\n        console.log('function used')\n        const result =  oldArrayProtoMethods[method].apply(this,arguments)\n        let inserted;\n        let ob = this.__ob__;\n        switch(method){\n            // 都是追加，应该再次劫持\n            case 'push':\n            case 'unshift':\n                inserted = args\n                break;\n            case  'splice':  //vue.$set原理\n                inserted = args.slice(2)\n            default:\n                break;\n        }\n        if(inserted) ob.observeArray(inserted)\n        return result;\n    }\n})","export function def(data,key,value){\n    Object.defineProperty(data,key,{\n        enumerable:false,\n        configurable:false,\n        value\n    })\n}","import {arrayMethods} from './array'\nimport { def} from '../util/index'\nclass Observer{\n    constructor(value){\n        // value.__ob__ = this;\n        def(value,'__ob__',this)\n        // definproperty 重新定义属性\n        if(Array.isArray(value)){\n            //数组操作方法\n            //函数劫持或者叫切片编程\n           value.__proto__ = arrayMethods\n            // debugger\n            this.observeArray(value)\n        }else{\n            this.walk(value);\n        }\n        \n    }\n    walk(data){\n        // console.log(data)\n        let keys = Object.keys(data)\n        keys.forEach((key)=>{\n            defineReactive(data,key,data[key])\n        })\n    }\n    observeArray(value){\n        value.forEach(item=>{\n            observer(item)\n        })\n    }\n\n}\n function defineReactive(data,key,value){\n     observer(value)\n        Object.defineProperty(data,key,{\n            get(){\n                console.log('get value')\n                return value\n            },\n            set(newValue){\n                if(newValue == value)return\n                observer(newValue)\n                value= newValue\n                console.log('set value')\n            }\n        })\n}\nexport function observer(data){\n    // debugger\n    // console.log(data)\n    if(typeof data !== 'object'&& data !== null)return //不是对象就检测对象\n    // console.log(data)\n    // debugger\n    return new Observer(data)\n}\n","\nimport {observer} from './observer/index'\nexport function initState(vm){\n    const opts = vm.$options\n    if(opts.props){\n        initProps(vm)\n    }\n    if(opts.methods){\n        initMethods(vm)\n    }\n    if(opts.data){\n        initData(vm)\n    }\n    if(opts.computed){\n        initComputed(vm)\n    }\n    if(opts.watch){\n        initWatch(vm)\n    }\n}\nfunction initProps(){}\nfunction initMethods(){}\nfunction initData(vm){\n    let data = vm.$options.data;\n    // debugger;\n    // console.log(typeof data)\n    vm._data = data = typeof data == 'function'?data.call(vm):data;\n    // 对象 或数组\n    // console.log(data)\n    // 数据劫持\n    observer(data)\n\n}\nfunction initComputed(){}\nfunction initWatch(){}","import {initState} from './state'\nexport function initMixin(Vue){\n    // console.log(options)\n    Vue.prototype._init = function(options){\n        const vm = this\n        vm.$options = options\n        // 响应式数据原理\n        // debugger;\n        initState(vm)\n        // 数据变化会更新\n    } \n}","import { initMixin } from './init'\nfunction Vue(options){\n    //初始化\n    this._init(options)\n    \n}\ninitMixin(Vue)\n\nexport default Vue;\n"],"names":[],"mappings":";;;;;;IAAA;IACA,IAAI,oBAAoB,GAAG,KAAK,CAAC,SAAS,CAAC;IACpC,IAAI,YAAY,GAAG,MAAM,CAAC,MAAM,CAAC,oBAAoB,EAAC;IAC7D,IAAI,OAAO,GAAG;IACd,IAAI,MAAM;IACV,IAAI,KAAK;IACT,IAAI,OAAO;IACX,IAAI,SAAS;IACb,IAAI,SAAS;IACb,IAAI,MAAM;IACV,IAAI,QAAQ;IACZ,EAAC;IACD,OAAO,CAAC,OAAO,CAAC,MAAM,EAAE;IACxB,IAAI,YAAY,CAAC,MAAM,CAAC,GAAG,SAAS,GAAG,IAAI,CAAC;IAC5C,QAAQ,OAAO,CAAC,GAAG,CAAC,eAAe,EAAC;IACpC,QAAQ,MAAM,MAAM,IAAI,oBAAoB,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,EAAC;IAC1E,QAAQ,IAAI,QAAQ,CAAC;IACrB,QAAQ,IAAI,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC;IAC7B,QAAQ,OAAO,MAAM;IACrB;IACA,YAAY,KAAK,MAAM,CAAC;IACxB,YAAY,KAAK,SAAS;IAC1B,gBAAgB,QAAQ,GAAG,KAAI;IAC/B,gBAAgB,MAAM;IACtB,YAAY,MAAM,QAAQ;IAC1B,gBAAgB,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,EAAC;IAGxC,SAAS;IACT,QAAQ,GAAG,QAAQ,EAAE,EAAE,CAAC,YAAY,CAAC,QAAQ,EAAC;IAC9C,QAAQ,OAAO,MAAM,CAAC;IACtB,MAAK;IACL,CAAC;;IChCM,SAAS,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC;IACnC,IAAI,MAAM,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,CAAC;IACnC,QAAQ,UAAU,CAAC,KAAK;IACxB,QAAQ,YAAY,CAAC,KAAK;IAC1B,QAAQ,KAAK;IACb,KAAK,EAAC;IACN;;ICJA,MAAM,QAAQ;IACd,IAAI,WAAW,CAAC,KAAK,CAAC;IACtB;IACA,QAAQ,GAAG,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,EAAC;IAChC;IACA,QAAQ,GAAG,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;IAChC;IACA;IACA,WAAW,KAAK,CAAC,SAAS,GAAG,aAAY;IACzC;IACA,YAAY,IAAI,CAAC,YAAY,CAAC,KAAK,EAAC;IACpC,SAAS,KAAI;IACb,YAAY,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAC7B,SAAS;IACT;IACA,KAAK;IACL,IAAI,IAAI,CAAC,IAAI,CAAC;IACd;IACA,QAAQ,IAAI,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAC;IACpC,QAAQ,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,GAAG;IAC5B,YAAY,cAAc,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,EAAC;IAC9C,SAAS,EAAC;IACV,KAAK;IACL,IAAI,YAAY,CAAC,KAAK,CAAC;IACvB,QAAQ,KAAK,CAAC,OAAO,CAAC,IAAI,EAAE;IAC5B,YAAY,QAAQ,CAAC,IAAI,EAAC;IAC1B,SAAS,EAAC;IACV,KAAK;AACL;IACA,CAAC;IACD,CAAC,SAAS,cAAc,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC;IACxC,KAAK,QAAQ,CAAC,KAAK,EAAC;IACpB,QAAQ,MAAM,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,CAAC;IACvC,YAAY,GAAG,EAAE;IACjB,gBAAgB,OAAO,CAAC,GAAG,CAAC,WAAW,EAAC;IACxC,gBAAgB,OAAO,KAAK;IAC5B,aAAa;IACb,YAAY,GAAG,CAAC,QAAQ,CAAC;IACzB,gBAAgB,GAAG,QAAQ,IAAI,KAAK,CAAC,MAAM;IAC3C,gBAAgB,QAAQ,CAAC,QAAQ,EAAC;IAClC,gBAAgB,KAAK,EAAE,SAAQ;IAC/B,gBAAgB,OAAO,CAAC,GAAG,CAAC,WAAW,EAAC;IACxC,aAAa;IACb,SAAS,EAAC;IACV,CAAC;IACM,SAAS,QAAQ,CAAC,IAAI,CAAC;IAC9B;IACA;IACA,IAAI,GAAG,OAAO,IAAI,KAAK,QAAQ,GAAG,IAAI,KAAK,IAAI,CAAC,MAAM;IACtD;IACA;IACA,IAAI,OAAO,IAAI,QAAQ,CAAC,IAAI,CAAC;IAC7B;;ICpDO,SAAS,SAAS,CAAC,EAAE,CAAC;IAC7B,IAAI,MAAM,IAAI,GAAG,EAAE,CAAC,SAAQ;IAC5B,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,CAEb;IACL,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,CAEf;IACL,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;IACjB,QAAQ,QAAQ,CAAC,EAAE,EAAC;IACpB,KAAK;IACL,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC,CAEhB;IACL,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,CAEb;IACL,CAAC;IAGD,SAAS,QAAQ,CAAC,EAAE,CAAC;IACrB,IAAI,IAAI,IAAI,GAAG,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC;IAChC;IACA;IACA,IAAI,EAAE,CAAC,KAAK,GAAG,IAAI,GAAG,OAAO,IAAI,IAAI,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC;IACnE;IACA;IACA;IACA,IAAI,QAAQ,CAAC,IAAI,EAAC;AAClB;IACA;;IC/BO,SAAS,SAAS,CAAC,GAAG,CAAC;IAC9B;IACA,IAAI,GAAG,CAAC,SAAS,CAAC,KAAK,GAAG,SAAS,OAAO,CAAC;IAC3C,QAAQ,MAAM,EAAE,GAAG,KAAI;IACvB,QAAQ,EAAE,CAAC,QAAQ,GAAG,QAAO;IAC7B;IACA;IACA,QAAQ,SAAS,CAAC,EAAE,EAAC;IACrB;IACA,MAAK;IACL;;ICVA,SAAS,GAAG,CAAC,OAAO,CAAC;IACrB;IACA,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,EAAC;IACvB;IACA,CAAC;IACD,SAAS,CAAC,GAAG;;;;;;;;"}